#!/bin/dash

# Function to confirm the action
confirm_action() {
    while true; do
        read -rp "Are you sure you want to rename the images? (Y/N) " response
        case $response in
            [Yy]* )
                return 0
                ;;
            [Nn]* )
                return 1
                ;;
            * )
                echo "Please respond with Y for 'Yes' or N for 'No'"
                ;;
        esac
    done
}

directory="$1"
number="$2"

if [ -z "$directory" ]; then
    echo "Usage: $0 <directory> <initial_number>"
    exit 1
fi

if [ -z "$number" ]; then
    read -rp "Do you want to start naming files from the current number of files in the directory? (Y/N) " response
    case $response in
        [Yy]* )
            number=$(find "$directory" -maxdepth 1 -type f | wc -l)
            ;;
        [Nn]* )
            read -rp "Enter an initial number: " number
            ;;
        * )
            echo "Please respond with Y for 'Yes' or N for 'No'"
            exit 1
            ;;
    esac
fi

i="$number"

# Confirm before renaming the images
if confirm_action; then
    for file in "$directory"/*.*g; do
        new_name=$(printf "%s/%d.jpg" "$directory" "$i")
        mv -i "$file" "$new_name"
        i=$((i+1))
    done
else
    echo "Image renaming cancelled"
fi
